import shipwellTheme from "./theme";

export const theme = shipwellTheme;

# Testing in shipwell/frontend-web

---

## What we will cover

<Steps>


- What to test for both new components and existing code
- The general approach and philosophy of testing
- Some nifty tips and tricks to make testing less daunting
- Discuss next steps as a team

</Steps>


---

## What to test

<Steps>


- New components!
  - But what does testing mean? What behavior do I test??
- Existing components!
  - But what if they don't have tests?
  - Or if they have old crufty enzyme tests?
- What about API calls? Or big components with lots of children?

</Steps>


<Notes>


- This is "unit-ish" testing
- User-centric testing
- Don't go down a rabbit hole

</Notes>


---

## New components

<Steps>


- TDD?
- If it makes sense!
- Snapshots?
- Acceptable, but usually there's a better assertion.

</Steps>


<Notes>


- Sometimes TDD doesn't vibe with the way we program
- Testing after that implementation can be a sort of "proof"

</Notes>


---

### Example:

```jsx
<FuelSurchargeTableCriteriaForm />
```

<Notes>


- Wrote tests after implementation
- Hard to write react-select _unit_ tests
  - cypress can help with that!
- Additional required fields
- Mode and equipment fetching
  - Mock, reset

</Notes>


---

import dontPanic from "./images/dont-panic.jpg";

### Existing code with little to no tests

<Steps>


- Don't stress!
- This is iterative
- Can we migrate from enzyme to testing-library for this component?
- Can we write _new_ tests using testing-library?

</Steps>


<img src={dontPanic} alt="Don't Panic" style={{ height: "300px" }} />

---

### Example:

```js
withStatusToasts(Component);
```

<Notes>


- Migrate to testing-library
- Assert using screen
- getByRole('heading') for toast titles
- what not to test: Toast and its props

</Notes>


---

### Older code in a giant component

<Steps>


- Don't stress!
- Can we write the changed behavior in a new, smaller component?
- This philosophy helps with any large component with children that make testing harder.
  - Compose smaller components and test _them_.
- Can we update existing tests to exercise some part of the integration of this composition?
- QA automation, webdriver, cypress can help with testing integration of broad parts of the app.

</Steps>


<img src={dontPanic} alt="Don't Panic" style={{ height: "300px" }} />

<Notes>


- No example exercise, but shipment details is a good example.
- Load board list, too
- We are working on automation.
- We don't have to cover absolutely everything with unit (-ish) test.

</Notes>


---

import testingTrophy from "./images/testing-trophy-banner.png";

## Testing philosophy

Write tests. Not too many. Mostly integration.

https://kentcdodds.com/blog/write-tests

The more your tests resemble the way your software is used, the more confidence they can give you.

https://testing-library.com/docs/guiding-principles

<img src={testingTrophy} alt="Testing trophy" style={{ width: "800px" }} />

---

## Tips and tricks

- screen.debug
- Roles
- Iterate on tests

---

## Next steps

<Steps>


- Pair programming for test-writing
- Accessibility and roles for components
  - E.g. titles for icon buttons, properly-related labels for inputs
- Custom/bespoke test utils for
  - redux tests,
  - mocking setup, and
  - other boilerplate
- Making tests part of our review process

</Steps>


---

## Resources

- https://kentcdodds.com/blog/write-tests
- https://kentcdodds.com/blog/unit-vs-integration-vs-e2e-tests
- https://kentcdodds.com/blog/common-mistakes-with-react-testing-library
- https://testing-library.com/docs/react-testing-library/api
- https://testing-library.com/docs/dom-testing-library/api-queries
- https://chrome.google.com/webstore/detail/testing-playground/hejbmebodbijjdhflfknehhcgaklhano
- https://testing-library.com/docs/dom-testing-library/cheatsheet

---

# ?

https://github.com/tupton/testing-lunch-and-learn
